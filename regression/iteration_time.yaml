name: joshua-regression-test-iteration-time
compute:
  gpus: 8  # Number of GPUs to use
  # cluster: TODO # Name of the cluster to use for this run
command: |-
  pip uninstall -y mosaicml-joshua
  cd joshua
  pip install -e '.[dev]'
  python regression/synthetic_dataset.py --create --name imagedataset --out /tmp/joshua_dataset/ --num_samples 300
  composer -n 2 regression/iterate_data.py --remote /tmp/joshua_dataset/ --local /tmp/local_dataset/ --batch_size 32
  python regression/synthetic_dataset.py --delete --out /tmp/joshua_dataset/
  rm -rf /tmp/local_dataset/

image: mosaicml/composer:latest
scheduling:
  resumable: true
  priority: medium
integrations:
- integration_type: git_repo
  git_repo: mosaicml/joshua
  git_branch: main
  ssh_clone: false
